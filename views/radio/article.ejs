<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="zh-CN" class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>爱车梦工厂</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale = 1.0,maximum-scale = 1.0, user-scalable=no">
    <link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <style>
html,body{font-size:16px}body{font-family:'Helvetica Neue',Helvetica,'Microsoft Yahei','Hiragino Sans GB','WenQuanYi Micro Hei',sans-serif}.wrapper{width:100%;max-width:740px;margin:0 auto;padding:20px;display:block}article>div{margin-bottom:1rem}article h2{font-size:1.5rem}article img{display:block;width:auto;max-width:100%;margin:0 auto}article p{margin-bottom:1rem;line-height:1.7rem}p.article-meta{margin-bottom:0.5rem}span svg{width:1rem;fill:#2f6f9f}span.tag{margin-left:5px;color:#2f6f9f}a:hover,a:focus{text-decoration:none}#like.active{color:#d44950}#like.active svg{fill:#d44950}.gray-text{color:#666}

    </style>
</head>

<body>
    <!--[if lt IE 9]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
    <!-- Add your site or application content here -->
    <div class="wrapper">
        <article>
            <h2><%= article.title %></h2>
            <p class="article-meta gray-text">
                <span><%= article.publishDate.formatDate %></span>
                <% if(article.author){ %>
                <span style="margin-left: 10px;">
                    作者：<%= article.author %>
                </span>
                <% } %>
            </p>
            <% if(article.tags){ %>
            <p>
                <span class="glyphicon glyphicon-tags gray-text"></span>
                <% article.tags.forEach(function(item){ %>
                <span class="tag"><%= item %></span>
                <% }) %>
            </p>
            <% } %>
            <div>
                <%- article.content %>
            </div>
        </article>
        <footer>
            <span style="margin-right: 1rem;" class="gray-text">阅读&nbsp;<%= article.pv %></span>
            <a href="javascript:likeArticle('<%= article.id %>')" id="like">
                <span>
                    <svg ng-repeat="glyph in glyphs" id="icon-like" mi-view-box="0 0 1024 1024" viewBox="0 0 1024 1024">
                        <title>like</title>
                        <path ng-repeat="path in glyph.paths" class="path0" mi-d="M933.248 335.104c-40-10.496-134.048-10.368-271.616-14.016 6.496-30.016 8-57.088 8-105.152 0-114.816-83.648-215.936-157.632-215.936-52.256 0-95.328 42.72-96 95.264-0.704 64.448-20.64 175.744-128 232.192-7.872 4.16-30.4 15.264-33.696 16.704l1.696 1.44c-16.8-14.496-40.096-25.6-64-25.6h-96c-52.928 0-96 43.072-96 96v512c0 52.928 43.072 96 96 96h96c38.080 0 69.952-23.008 85.376-55.264 0.384 0.128 1.056 0.32 1.504 0.384 2.112 0.576 4.608 1.184 7.648 1.984 0.576 0.16 0.864 0.224 1.472 0.384 18.432 4.576 53.92 13.056 129.76 30.496 16.256 3.712 102.144 22.016 191.104 22.016h174.944c53.312 0 91.744-20.512 114.624-61.696 0.32-0.64 7.68-15.008 13.696-34.432 4.512-14.624 6.176-35.328 0.736-56.32 34.368-23.616 45.44-59.328 52.64-82.56 12.064-38.112 8.448-66.752 0.064-87.264 19.328-18.24 35.808-46.048 42.752-88.512 4.32-26.304-0.32-53.376-12.448-75.904 18.112-20.352 26.368-45.952 27.328-69.632l0.384-6.688c0.224-4.192 0.416-6.784 0.416-16 0-40.416-28-91.968-90.752-109.888zM224 928c0 17.696-14.304 32-32 32h-96c-17.696 0-32-14.304-32-32v-512c0-17.696 14.304-32 32-32h96c17.696 0 32 14.304 32 32v512zM959.264 465.12c-0.64 15.808-7.264 46.88-63.264 46.88-48 0-64 0-64 0-8.864 0-16 7.168-16 16s7.136 16 16 16c0 0 14.016 0 62.016 0s54.304 39.808 51.2 59.008c-3.968 23.872-15.168 68.992-69.216 68.992-53.984 0-76 0-76 0-8.864 0-16 7.136-16 16 0 8.8 7.136 16 16 16 0 0 38.016 0 63.008 0 54.016 0 49.248 41.184 41.504 65.76-10.208 32.288-16.448 62.24-84.512 62.24-23.008 0-52.192 0-52.192 0-8.864 0-16 7.136-16 16 0 8.8 7.136 16 16 16 0 0 22.176 0 50.176 0 35.008 0 36.64 33.12 32.992 44.992-4 12.992-8.736 22.624-8.928 23.072-9.664 17.44-25.248 27.936-58.24 27.936h-174.944c-87.872 0-175.040-19.936-177.28-20.448-132.928-30.624-139.936-32.992-148.288-35.36 0 0-27.072-4.576-27.072-28.192l-0.224-441.984c0-15.008 9.568-28.576 25.408-33.344 1.984-0.768 4.672-1.6 6.592-2.4 146.176-60.544 190.688-193.28 192-302.272 0.192-15.328 12-32 32-32 33.824 0 93.632 67.904 93.632 151.936 0 75.872-3.072 88.992-29.632 168.064 320 0 317.76 4.608 345.984 12 35.008 10.016 38.016 39.008 38.016 48.992 0 10.976-0.32 9.376-0.736 20.128zM144 832c-26.496 0-48 21.504-48 48s21.504 48 48 48 48-21.504 48-48-21.504-48-48-48zM144 896c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z" mi-fill="" mi-opacity="" d="M933.248 335.104c-40-10.496-134.048-10.368-271.616-14.016 6.496-30.016 8-57.088 8-105.152 0-114.816-83.648-215.936-157.632-215.936-52.256 0-95.328 42.72-96 95.264-0.704 64.448-20.64 175.744-128 232.192-7.872 4.16-30.4 15.264-33.696 16.704l1.696 1.44c-16.8-14.496-40.096-25.6-64-25.6h-96c-52.928 0-96 43.072-96 96v512c0 52.928 43.072 96 96 96h96c38.080 0 69.952-23.008 85.376-55.264 0.384 0.128 1.056 0.32 1.504 0.384 2.112 0.576 4.608 1.184 7.648 1.984 0.576 0.16 0.864 0.224 1.472 0.384 18.432 4.576 53.92 13.056 129.76 30.496 16.256 3.712 102.144 22.016 191.104 22.016h174.944c53.312 0 91.744-20.512 114.624-61.696 0.32-0.64 7.68-15.008 13.696-34.432 4.512-14.624 6.176-35.328 0.736-56.32 34.368-23.616 45.44-59.328 52.64-82.56 12.064-38.112 8.448-66.752 0.064-87.264 19.328-18.24 35.808-46.048 42.752-88.512 4.32-26.304-0.32-53.376-12.448-75.904 18.112-20.352 26.368-45.952 27.328-69.632l0.384-6.688c0.224-4.192 0.416-6.784 0.416-16 0-40.416-28-91.968-90.752-109.888zM224 928c0 17.696-14.304 32-32 32h-96c-17.696 0-32-14.304-32-32v-512c0-17.696 14.304-32 32-32h96c17.696 0 32 14.304 32 32v512zM959.264 465.12c-0.64 15.808-7.264 46.88-63.264 46.88-48 0-64 0-64 0-8.864 0-16 7.168-16 16s7.136 16 16 16c0 0 14.016 0 62.016 0s54.304 39.808 51.2 59.008c-3.968 23.872-15.168 68.992-69.216 68.992-53.984 0-76 0-76 0-8.864 0-16 7.136-16 16 0 8.8 7.136 16 16 16 0 0 38.016 0 63.008 0 54.016 0 49.248 41.184 41.504 65.76-10.208 32.288-16.448 62.24-84.512 62.24-23.008 0-52.192 0-52.192 0-8.864 0-16 7.136-16 16 0 8.8 7.136 16 16 16 0 0 22.176 0 50.176 0 35.008 0 36.64 33.12 32.992 44.992-4 12.992-8.736 22.624-8.928 23.072-9.664 17.44-25.248 27.936-58.24 27.936h-174.944c-87.872 0-175.040-19.936-177.28-20.448-132.928-30.624-139.936-32.992-148.288-35.36 0 0-27.072-4.576-27.072-28.192l-0.224-441.984c0-15.008 9.568-28.576 25.408-33.344 1.984-0.768 4.672-1.6 6.592-2.4 146.176-60.544 190.688-193.28 192-302.272 0.192-15.328 12-32 32-32 33.824 0 93.632 67.904 93.632 151.936 0 75.872-3.072 88.992-29.632 168.064 320 0 317.76 4.608 345.984 12 35.008 10.016 38.016 39.008 38.016 48.992 0 10.976-0.32 9.376-0.736 20.128zM144 832c-26.496 0-48 21.504-48 48s21.504 48 48 48 48-21.504 48-48-21.504-48-48-48zM144 896c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"></path>
                    </svg>
                </span>
                <span id="likeNum"><%= article.like %></span>
            </a>
        </footer>
    </div>
</body>
<script>
    (function(){
        var liked = false;
        function $(selector){
            return document.querySelector(selector);
        }
        function like(id){
            if(liked){
                return;
            }
            var xhr;
            if (window.ActiveXObject) {
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            } else if (window.XMLHttpRequest) {
                xhr = new XMLHttpRequest();
            }
            xhr.open("PATCH", "/radio/article/" + id, true);
            xhr.onload = function(event) {
                var result = JSON.parse(xhr.response);
                if(result.msg == 'success'){
                    $('#like').className = 'active';
                    var $likeNum = $('#likeNum');
                    $likeNum.innerText = $likeNum.innerText - 0 + 1;
                }else{
                    liked = false;
                }
            };
            xhr.send();
            liked = true;
        }
        window.likeArticle = like;
    })();
</script>
</html>
